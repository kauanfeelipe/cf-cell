import{r,K as R,j as e,U as q,V as D,Y as F,_ as G,$ as k,o as S,a0 as P,a1 as V,X as H,a2 as J}from"./react-vendor-BsKB5qO5.js";import{u as K,a as Q,b as W,c as X,s as Y,i as Z,h as v,E as ee,L as ae,d as te,f as se}from"./index-D6_P2-Jn.js";import"./vendor-BcyfbpGg.js";import"./animation-vendor-DdGBw1fV.js";import"./supabase-vendor-B_pmqJd-.js";const re=(a,s=300)=>{const[i,u]=r.useState(a);return r.useEffect(()=>{const m=setTimeout(()=>{u(a)},s);return()=>{clearTimeout(m)}},[a,s]),i},w={nome:"",marca:"",armazenamento:"",memoria_ram:"",camera:"",bateria:"",cor:"",condicao:"Novo",situacao:"Normal",valor:"",imagem_url:""},le=({formData:a,onInputChange:s,onImageUpload:i,onSubmit:u,onClose:m,uploading:d,isSubmitting:x,isEditing:n})=>e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 md:p-4 bg-black/80 backdrop-blur-sm overflow-y-auto",children:e.jsxs("div",{className:"bg-dark-surface border border-white/10 rounded-2xl p-4 md:p-6 max-w-2xl w-full shadow-2xl my-4 md:my-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[n?e.jsx(P,{className:"text-primary"}):e.jsx(k,{className:"text-primary"}),n?"Editar Celular":"Novo Celular"]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-white transition-colors",type:"button",children:e.jsx(H,{size:24})})]}),e.jsxs("form",{onSubmit:u,className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 md:gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:"Nome do Modelo"}),e.jsx("input",{name:"nome",value:a.nome,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["Marca ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"marca",value:a.marca,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:"Valor (R$)"}),e.jsx("input",{type:"number",name:"valor",value:a.valor,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none",required:!0,min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["Armazenamento ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"armazenamento",value:a.armazenamento,onChange:s,placeholder:"128GB",className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["RAM ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"memoria_ram",value:a.memoria_ram,onChange:s,placeholder:"4GB",className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["Cor ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"cor",value:a.cor,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["Câmera ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"camera",value:a.camera,onChange:s,placeholder:"48MP",className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:["Bateria ",e.jsx("span",{className:"text-gray-600 text-xs",children:"(Opc)"})]}),e.jsx("input",{name:"bateria",value:a.bateria,onChange:s,placeholder:"5000mAh",className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:"Imagem do Produto"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-16 h-16 md:w-20 md:h-20 bg-dark border border-white/10 rounded-lg overflow-hidden flex-shrink-0",children:[a.imagem_url?e.jsx("img",{src:a.imagem_url,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:e.jsx(S,{size:20})}),d&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-primary"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",onChange:i,className:`block w-full text-xs md:text-sm text-gray-400
                                        file:mr-2 md:file:mr-4 file:py-1.5 md:file:py-2 file:px-3 md:file:px-4
                                        file:rounded-full file:border-0
                                        file:text-xs md:file:text-sm file:font-semibold
                                        file:bg-primary file:text-dark
                                        hover:file:bg-primary-dark
                                        cursor-pointer`}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG, WebP. Max 2MB."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:"Condição"}),e.jsxs("select",{name:"condicao",value:a.condicao,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none",children:[e.jsx("option",{value:"Novo",children:"Novo"}),e.jsx("option",{value:"Seminovo",children:"Seminovo"}),e.jsx("option",{value:"Usado",children:"Usado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs md:text-sm font-medium text-gray-400 mb-0.5",children:"Situação"}),e.jsxs("select",{name:"situacao",value:a.situacao,onChange:s,className:"w-full bg-dark border border-white/10 rounded-lg p-2 md:p-2.5 text-sm md:text-base text-white focus:border-primary focus:outline-none",children:[e.jsx("option",{value:"Normal",children:"Normal"}),e.jsx("option",{value:"Oferta",children:"Oferta"}),e.jsx("option",{value:"Lançamento",children:"Lançamento"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-4 md:mt-6 pt-4 border-t border-white/10",children:[e.jsx("button",{type:"button",onClick:m,className:"px-6 py-2.5 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 transition-colors font-medium",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:d||x,className:"px-6 py-2.5 rounded-lg bg-primary hover:bg-primary-dark text-dark font-bold transition-all shadow-lg shadow-primary/20 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(J,{size:18}),d||x?"Enviando...":"Salvar"]})]})]})]})}),oe=({phone:a,onEdit:s,onDelete:i})=>e.jsxs("div",{className:"bg-dark-surface border border-white/10 rounded-xl overflow-hidden hover:border-primary/50 transition-all group",children:[e.jsxs("div",{className:"h-56 md:h-64 lg:h-72 bg-gray-800 relative overflow-hidden",children:[a.imagem_url?e.jsx("img",{src:a.imagem_url,alt:a.nome,loading:"lazy",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:e.jsx(S,{size:40})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 opacity-100 md:opacity-0 md:group-hover:opacity-100 transition-opacity z-10",children:[e.jsx("button",{onClick:()=>s(a),className:"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors shadow-lg",type:"button",children:e.jsx(P,{size:16})}),e.jsx("button",{onClick:()=>i(a.id),className:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors shadow-lg",type:"button",children:e.jsx(V,{size:16})})]}),a.situacao!=="Normal"&&e.jsx("span",{className:`absolute top-2 left-2 px-2 py-1 rounded text-xs font-bold text-white z-10 ${a.situacao==="Oferta"?"bg-red-500":"bg-blue-500"}`,children:a.situacao})]}),e.jsxs("div",{className:"p-3 md:p-4",children:[e.jsx("h3",{className:"font-bold text-base md:text-lg mb-1 truncate",children:a.nome}),e.jsx("p",{className:"text-primary font-bold text-lg md:text-xl mb-2 md:mb-3",children:se(a.valor)}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-400",children:[a.armazenamento&&e.jsx("div",{className:"bg-white/5 p-1.5 rounded text-center",children:a.armazenamento}),a.memoria_ram&&e.jsx("div",{className:"bg-white/5 p-1.5 rounded text-center",children:a.memoria_ram}),e.jsx("div",{className:"bg-white/5 p-1.5 rounded text-center col-span-2",children:a.condicao})]})]})]}),xe=()=>{const a=R(),[s,i]=r.useState(!1),[u,m]=r.useState(!1),[d,x]=r.useState(null),[n,M]=r.useState(""),[h,b]=r.useState(w),{data:_,isLoading:E,isError:A,error:L}=K({limit:100}),g=Q(),p=W(),C=X(),f=re(n,300),j=_?.products||[],z=r.useMemo(()=>{if(!f)return j;const t=f.toLowerCase();return j.filter(l=>l.nome?.toLowerCase().includes(t)||l.marca?.toLowerCase().includes(t))},[j,f]),O=r.useCallback(async()=>{await Y.auth.signOut(),a("/admin/login")},[a]),T=r.useCallback(t=>{const{name:l,value:o}=t.target;b(c=>({...c,[l]:o}))},[]),U=r.useCallback(async t=>{const l=t.target.files?.[0];if(l)try{i(!0);const o=await Z.upload(l);b(c=>({...c,imagem_url:o}))}catch(o){const c=v(o,"AdminDashboard.handleImageUpload");alert(`Erro ao fazer upload: ${c.message}`)}finally{i(!1)}},[]),y=r.useCallback((t=null)=>{t?(x(t),b({nome:t.nome||"",marca:t.marca||"",armazenamento:t.armazenamento||"",memoria_ram:t.memoria_ram||"",camera:t.camera||"",bateria:t.bateria||"",cor:t.cor||"",condicao:t.condicao||"Novo",situacao:t.situacao||"Normal",valor:t.valor||"",imagem_url:t.imagem_url||""})):(x(null),b(w)),m(!0)},[]),N=r.useCallback(()=>{m(!1),x(null),b(w)},[]),B=r.useCallback(async t=>{t.preventDefault();try{const{id:l,created_at:o,...c}=h;d?await p.mutateAsync({id:d.id,data:c}):await g.mutateAsync(c),N()}catch(l){const o=v(l,"AdminDashboard.handleSubmit");alert(`Erro ao salvar: ${o.message}`)}},[h,d,g,p,N]),I=r.useCallback(async t=>{if(window.confirm("Tem certeza que deseja excluir este item?"))try{await C.mutateAsync(t)}catch(l){const o=v(l,"AdminDashboard.handleDelete");alert(`Erro ao excluir: ${o.message}`)}},[C]),$=g.isPending||p.isPending;return e.jsxs("div",{className:"min-h-screen bg-dark text-white font-body",children:[e.jsxs("header",{className:"bg-dark-surface border-b border-white/10 px-6 py-4 flex justify-between items-center sticky top-0 z-10 backdrop-blur-md bg-opacity-90",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-primary",children:"CF CELL Admin"}),e.jsx("span",{className:"bg-white/5 px-3 py-1 rounded-full text-xs text-gray-400 border border-white/10",children:"Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(q,{to:"/",className:"flex items-center gap-2 text-gray-400 hover:text-primary transition-colors text-sm font-medium",children:[e.jsx(D,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Ir para o Site"})]}),e.jsxs("button",{onClick:O,className:"flex items-center gap-2 text-gray-400 hover:text-red-400 transition-colors text-sm font-medium",type:"button",children:[e.jsx(F,{size:18}),e.jsx("span",{className:"hidden sm:inline",children:"Sair"})]})]})]}),e.jsxs("main",{className:"p-6 container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 gap-4",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(G,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar celular...",value:n,onChange:t=>M(t.target.value),className:"w-full bg-dark-surface border border-white/10 rounded-lg py-2 pl-10 pr-4 text-white focus:outline-none focus:border-primary focus:ring-1 focus:ring-primary transition-all"})]}),e.jsxs("button",{onClick:()=>y(),className:"w-full md:w-auto bg-primary hover:bg-primary-dark text-dark font-bold px-6 py-2.5 rounded-lg flex items-center justify-center gap-2 transition-all shadow-lg shadow-primary/20 hover:shadow-primary/40",type:"button",children:[e.jsx(k,{size:20}),"Novo Celular"]})]}),A&&e.jsx(ee,{error:L,title:"Erro ao carregar dados",onRetry:()=>window.location.reload(),className:"mb-6"}),E?e.jsx(ae,{size:"lg",className:"h-64"}):z.length===0?e.jsx(te,{message:n?"Nenhum celular encontrado para esta busca.":"Nenhum celular encontrado.",description:n?"Tente buscar por outro termo.":"Adicione um novo item para começar.",action:!n&&e.jsxs("button",{onClick:()=>y(),className:"btn-primary",type:"button",children:[e.jsx(k,{size:20}),"Adicionar Primeiro Item"]})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 md:gap-6",children:z.map(t=>e.jsx(oe,{phone:t,onEdit:y,onDelete:I},t.id))})]}),u&&e.jsx(le,{formData:h,onInputChange:T,onImageUpload:U,onSubmit:B,onClose:N,uploading:s,isSubmitting:$,isEditing:!!d})]})};export{xe as default};
